/*! For license information please see a842db86.ea6a0daf.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[431247],{467083:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var r=t(824246),i=t(511151);const o={id:"02-adding-a-basic-permission-check",title:"2. Adding a basic permission check",description:"Explains how to add a basic permission check to a Backstage plugin"},s=void 0,a={unversionedId:"permissions/plugin-authors/02-adding-a-basic-permission-check",id:"permissions/plugin-authors/02-adding-a-basic-permission-check",title:"2. Adding a basic permission check",description:"Explains how to add a basic permission check to a Backstage plugin",source:"@site/../docs/permissions/plugin-authors/02-adding-a-basic-permission-check.md",sourceDirName:"permissions/plugin-authors",slug:"/permissions/plugin-authors/02-adding-a-basic-permission-check",permalink:"/docs/permissions/plugin-authors/02-adding-a-basic-permission-check",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/../docs/permissions/plugin-authors/02-adding-a-basic-permission-check.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"02-adding-a-basic-permission-check",title:"2. Adding a basic permission check",description:"Explains how to add a basic permission check to a Backstage plugin"},sidebar:"docs",previous:{title:"1. Tutorial setup",permalink:"/docs/permissions/plugin-authors/01-setup"},next:{title:"3. Adding a resource permission check",permalink:"/docs/permissions/plugin-authors/03-adding-a-resource-permission-check"}},c={},l=[{value:"Creating a new permission",id:"creating-a-new-permission",level:2},{value:"Authorizing using the new permission",id:"authorizing-using-the-new-permission",level:2},{value:"Test the authorized create endpoint",id:"test-the-authorized-create-endpoint",level:2}];function u(e){const n=Object.assign({p:"p",a:"a",em:"em",code:"code",h2:"h2",pre:"pre",blockquote:"blockquote"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["If the outcome of a permission check doesn't need to change for different ",(0,r.jsx)(n.a,{href:"/docs/permissions/concepts#resources-and-rules",children:"resources"}),", you can use a ",(0,r.jsx)(n.em,{children:"basic permission check"}),". For this kind of check, we simply need to define a ",(0,r.jsx)(n.a,{href:"/docs/permissions/concepts#resources-and-rules",children:"permission"}),", and call ",(0,r.jsx)(n.code,{children:"authorize"})," with it."]}),"\n",(0,r.jsxs)(n.p,{children:["For this tutorial, we'll use a basic permission check to authorize the ",(0,r.jsx)(n.code,{children:"create"})," endpoint in our todo-backend. This will allow Backstage integrators to control whether each of their users is authorized to create todos by adjusting their ",(0,r.jsx)(n.a,{href:"/docs/permissions/concepts#policy",children:"permission policy"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["We'll start by creating a new permission, and then we'll use the permission api to call ",(0,r.jsx)(n.code,{children:"authorize"})," with it during todo creation."]}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-new-permission",children:"Creating a new permission"}),"\n",(0,r.jsxs)(n.p,{children:["Let's navigate to the file ",(0,r.jsx)(n.code,{children:"plugins/todo-list-common/src/permissions.ts"})," and add our first permission:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="plugins/todo-list-common/src/permissions.ts"',children:"import { createPermission } from '@backstage/plugin-permission-common';\n\n/* highlight-remove-start */\nexport const tempExamplePermission = createPermission({\n  name: 'temp.example.noop',\n  attributes: {},\n/* highlight-remove-end */\n/* highlight-add-start */\nexport const todoListCreatePermission = createPermission({\n  name: 'todo.list.create',\n  attributes: { action: 'create' },\n/* highlight-add-end */\n});\n\n/* highlight-remove-next-line */\nexport const todoListPermissions = [tempExamplePermission];\n/* highlight-add-next-line */\nexport const todoListPermissions = [todoListCreatePermission];\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For this tutorial, we've automatically exported all permissions from this file (see ",(0,r.jsx)(n.code,{children:"plugins/todo-list-common/src/index.ts"}),")."]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Note: We use a separate ",(0,r.jsx)(n.code,{children:"todo-list-common"})," package since all permissions authorized by your plugin should be exported from a ",(0,r.jsx)(n.a,{href:"https://backstage.io/docs/local-dev/cli-build-system#package-roles",children:'"common-library" package'}),". This allows Backstage integrators to reference them in frontend components as well as permission policies."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"authorizing-using-the-new-permission",children:"Authorizing using the new permission"}),"\n",(0,r.jsx)(n.p,{children:"Install the following module:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ yarn workspace @internal/plugin-todo-list-backend \\\n  add @backstage/plugin-permission-common @backstage/plugin-permission-node @internal/plugin-todo-list-common\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Edit ",(0,r.jsx)(n.code,{children:"plugins/todo-list-backend/src/service/router.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="plugins/todo-list-backend/src/service/router.ts"',children:"/* highlight-remove-start */\nimport { InputError } from '@backstage/errors';\nimport { IdentityApi } from '@backstage/plugin-auth-node';\n/* highlight-remove-end */\n/* highlight-add-start */\nimport { InputError, NotAllowedError } from '@backstage/errors';\nimport { getBearerTokenFromAuthorizationHeader, IdentityApi } from '@backstage/plugin-auth-node';\nimport { PermissionEvaluator, AuthorizeResult } from '@backstage/plugin-permission-common';\nimport { createPermissionIntegrationRouter } from '@backstage/plugin-permission-node';\nimport { todoListCreatePermission } from '@internal/plugin-todo-list-common';\n/* highlight-add-end */\n\nexport interface RouterOptions {\n  logger: Logger;\n  identity: IdentityApi;\n  /* highlight-add-next-line */\n  permissions: PermissionEvaluator;\n}\n\nexport async function createRouter(\n  options: RouterOptions,\n): Promise<express.Router> {\n  /* highlight-remove-next-line */\n  const { logger, identity } = options;\n  /* highlight-add-next-line */\n  const { logger, identity, permissions } = options;\n\n  /* highlight-add-start */\n  const permissionIntegrationRouter = createPermissionIntegrationRouter({\n    permissions: [todoListCreatePermission],\n  });\n  /* highlight-add-end */\n\n  const router = Router();\n  router.use(express.json());\n\n  router.get('/health', (_, response) => {\n    logger.info('PONG!');\n    response.json({ status: 'ok' });\n  });\n\n  /* highlight-add-next-line */\n  router.use(permissionIntegrationRouter);\n\n  router.get('/todos', async (_req, res) => {\n    res.json(getAll());\n  });\n\n  router.post('/todos', async (req, res) => {\n    let author: string | undefined = undefined;\n\n    const user = await identity.getIdentity({ request: req });\n    author = user?.identity.userEntityRef;\n    /* highlight-add-start */\n    const token = getBearerTokenFromAuthorizationHeader(\n      req.header('authorization'),\n    );\n    const decision = (\n      await permissions.authorize([{ permission: todoListCreatePermission }], {\n      token,\n      })\n    )[0];\n\n    if (decision.result === AuthorizeResult.DENY) {\n      throw new NotAllowedError('Unauthorized');\n    }\n    /* highlight-add-end */\n\n    if (!isTodoCreateRequest(req.body)) {\n      throw new InputError('Invalid payload');\n    }\n\n    const todo = add({ title: req.body.title, author });\n    res.json(todo);\n  });\n\n  // ...\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Pass the ",(0,r.jsx)(n.code,{children:"permissions"})," object to the plugin in ",(0,r.jsx)(n.code,{children:"packages/backend/src/plugins/todolist.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="packages/backend/src/plugins/todolist.ts"',children:"import { DefaultIdentityClient } from '@backstage/plugin-auth-node';\nimport { createRouter } from '@internal/plugin-todo-list-backend';\nimport { Router } from 'express';\nimport { PluginEnvironment } from '../types';\n\nexport default async function createPlugin({\n  logger,\n  discovery,\n  /* highlight-add-next-line */\n  permissions,\n}: PluginEnvironment): Promise<Router> {\n  return await createRouter({\n    logger,\n    identity: DefaultIdentityClient.create({\n      discovery,\n      issuer: await discovery.getExternalBaseUrl('auth'),\n    }),\n    /* highlight-add-next-line */\n    permissions,\n  });\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"That's it! Now your plugin is fully configured. Let's try to test the logic by denying the permission."}),"\n",(0,r.jsx)(n.h2,{id:"test-the-authorized-create-endpoint",children:"Test the authorized create endpoint"}),"\n",(0,r.jsxs)(n.p,{children:["Before running this step, please make sure you followed the steps described in ",(0,r.jsx)(n.a,{href:"/docs/permissions/getting-started",children:"Getting started"})," section."]}),"\n",(0,r.jsxs)(n.p,{children:["In order to test the logic above, the integrators of your backstage instance need to change their permission policy to return ",(0,r.jsx)(n.code,{children:"DENY"})," for our newly-created permission:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="packages/backend/src/plugins/permission.ts"',children:"/* highlight-add-start */\nimport {\n  BackstageIdentityResponse,\n} from '@backstage/plugin-auth-node';\n/* highlight-add-end */\nimport {\n  PermissionPolicy,\n  /* highlight-add-next-line */\n  PolicyQuery,\n} from '@backstage/plugin-permission-node';\n/* highlight-add-start */\nimport { isPermission } from '@backstage/plugin-permission-common';\nimport { todoListCreatePermission } from '@internal/plugin-todo-list-common';\n/* highlight-add-end */\n\nclass TestPermissionPolicy implements PermissionPolicy {\n  /* highlight-remove-next-line */\n  async handle(): Promise<PolicyDecision> {\n  /* highlight-add-start */\n  async handle(\n    request: PolicyQuery,\n    _user?: BackstageIdentityResponse,\n  ): Promise<PolicyDecision> {\n    if (isPermission(request.permission, todoListCreatePermission)) {\n      return {\n        result: AuthorizeResult.DENY,\n      };\n    }\n  /* highlight-add-end */\n\n    return {\n      result: AuthorizeResult.ALLOW,\n    };\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Now the frontend should show an error whenever you try to create a new Todo item."}),"\n",(0,r.jsxs)(n.p,{children:["Let's flip the result back to ",(0,r.jsx)(n.code,{children:"ALLOW"})," before moving on."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"if (isPermission(request.permission, todoListCreatePermission)) {\n  return {\n    /* highlight-remove-next-line */\n    result: AuthorizeResult.DENY,\n    /* highlight-add-next-line */\n    result: AuthorizeResult.ALLOW,\n  };\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["At this point everything is working but if you run ",(0,r.jsx)(n.code,{children:"yarn tsc"})," you'll get some errors, let's fix those up."]}),"\n",(0,r.jsxs)(n.p,{children:["First we'll clean up the ",(0,r.jsx)(n.code,{children:"plugins/todo-list-backend/src/service/router.test.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="plugins/todo-list-backend/src/service/router.test.ts"',children:"import { getVoidLogger } from '@backstage/backend-common';\nimport { DefaultIdentityClient } from '@backstage/plugin-auth-node';\n/* highlight-add-next-line */\nimport { PermissionEvaluator } from '@backstage/plugin-permission-common';\nimport express from 'express';\nimport request from 'supertest';\n\nimport { createRouter } from './router';\n\n/* highlight-add-start */\nconst mockedAuthorize: jest.MockedFunction<PermissionEvaluator['authorize']> =\n  jest.fn();\nconst mockedPermissionQuery: jest.MockedFunction<\n  PermissionEvaluator['authorizeConditional']\n> = jest.fn();\n\nconst permissionEvaluator: PermissionEvaluator = {\n  authorize: mockedAuthorize,\n  authorizeConditional: mockedPermissionQuery,\n};\n/* highlight-add-end */\n\ndescribe('createRouter', () => {\n  let app: express.Express;\n\n  beforeAll(async () => {\n    const router = await createRouter({\n      logger: getVoidLogger(),\n      identity: {} as DefaultIdentityClient,\n      /* highlight-add-next-line */\n      permissions: permissionEvaluator,\n    });\n    app = express().use(router);\n  });\n\n  beforeEach(() => {\n    jest.resetAllMocks();\n  });\n\n  describe('GET /health', () => {\n    it('returns ok', async () => {\n      const response = await request(app).get('/health');\n\n      expect(response.status).toEqual(200);\n      expect(response.body).toEqual({ status: 'ok' });\n    });\n  });\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Then we want to update the ",(0,r.jsx)(n.code,{children:"plugins/todo-list-backend/src/service/standaloneServer.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="plugins/todo-list-backend/src/service/standaloneServer.ts"',children:"import {\n  createServiceBuilder,\n  loadBackendConfig,\n  SingleHostDiscovery,\n  /* highlight-add-next-line */\n  ServerTokenManager,\n} from '@backstage/backend-common';\nimport { DefaultIdentityClient } from '@backstage/plugin-auth-node';\n/* highlight-add-next-line */\nimport { ServerPermissionClient } from '@backstage/plugin-permission-node';\nimport { Server } from 'http';\nimport { Logger } from 'winston';\nimport { createRouter } from './router';\n\nexport interface ServerOptions {\n  port: number;\n  enableCors: boolean;\n  logger: Logger;\n}\n\nexport async function startStandaloneServer(\n  options: ServerOptions,\n): Promise<Server> {\n  const logger = options.logger.child({ service: 'todo-list-backend' });\n  logger.debug('Starting application server...');\n  const config = await loadBackendConfig({ logger, argv: process.argv });\n  const discovery = SingleHostDiscovery.fromConfig(config);\n  /* highlight-add-start */\n  const tokenManager = ServerTokenManager.fromConfig(config, {\n    logger,\n  });\n  const permissions = ServerPermissionClient.fromConfig(config, {\n    discovery,\n    tokenManager,\n  });\n  /* highlight-add-end */\n  const router = await createRouter({\n    logger,\n    identity: DefaultIdentityClient.create({\n      discovery,\n      issuer: await discovery.getExternalBaseUrl('auth'),\n    }),\n    /* highlight-add-next-line */\n    permissions,\n  });\n\n  let service = createServiceBuilder(module)\n    .setPort(options.port)\n    .addRouter('/todo-list', router);\n  if (options.enableCors) {\n    service = service.enableCors({ origin: 'http://localhost:3000' });\n  }\n\n  return await service.start().catch(err => {\n    logger.error(err);\n    process.exit(1);\n  });\n}\n\nmodule.hot?.accept();\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Finally, we need to update ",(0,r.jsx)(n.code,{children:"plugins/todo-list-backend/src/plugin.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="plugins/todo-list-backend/src/plugin.ts"',children:"import { loggerToWinstonLogger } from '@backstage/backend-common';\nimport {\n  coreServices,\n  createBackendPlugin,\n} from '@backstage/backend-plugin-api';\nimport { createRouter } from './service/router';\n\n/**\n* The example TODO list backend plugin.\n*\n* @alpha\n*/\nexport const exampleTodoListPlugin = createBackendPlugin({\n  pluginId: 'exampleTodoList',\n  register(env) {\n    env.registerInit({\n      deps: {\n        identity: coreServices.identity,\n        logger: coreServices.logger,\n        httpRouter: coreServices.httpRouter,\n        /* highlight-add-next-line */\n        permissions: coreServices.permissions,\n      },\n      /* highlight-remove-next-line */\n      async init({ identity, logger, httpRouter }) {\n      /* highlight-add-next-line */\n      async init({ identity, logger, httpRouter, permissions }) {\n        httpRouter.use(\n          await createRouter({\n            identity,\n            logger: loggerToWinstonLogger(logger),\n            permissions,\n          }),\n        );\n      },\n    });\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Now when you run ",(0,r.jsx)(n.code,{children:"yarn tsc"})," you should have no more errors."]})]})}const d=function(e={}){const{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,Object.assign({},e,{children:(0,r.jsx)(u,e)})):u(e)}},862525:e=>{var n=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var n={},t=0;t<10;t++)n["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(n).map((function(e){return n[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,i){for(var o,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in o=Object(arguments[c]))t.call(o,l)&&(a[l]=o[l]);if(n){s=n(o);for(var u=0;u<s.length;u++)r.call(o,s[u])&&(a[s[u]]=o[s[u]])}}return a}},371426:(e,n,t)=>{t(862525);var r=t(827378),i=60103;if(n.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var o=Symbol.for;i=o("react.element"),n.Fragment=o("react.fragment")}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,n,t){var r,o={},l=null,u=null;for(r in void 0!==t&&(l=""+t),void 0!==n.key&&(l=""+n.key),void 0!==n.ref&&(u=n.ref),n)a.call(n,r)&&!c.hasOwnProperty(r)&&(o[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===o[r]&&(o[r]=n[r]);return{$$typeof:i,type:e,key:l,ref:u,props:o,_owner:s.current}}n.jsx=l,n.jsxs=l},541535:(e,n,t)=>{var r=t(862525),i=60103,o=60106;n.Fragment=60107,n.StrictMode=60108,n.Profiler=60114;var s=60109,a=60110,c=60112;n.Suspense=60113;var l=60115,u=60116;if("function"==typeof Symbol&&Symbol.for){var d=Symbol.for;i=d("react.element"),o=d("react.portal"),n.Fragment=d("react.fragment"),n.StrictMode=d("react.strict_mode"),n.Profiler=d("react.profiler"),s=d("react.provider"),a=d("react.context"),c=d("react.forward_ref"),n.Suspense=d("react.suspense"),l=d("react.memo"),u=d("react.lazy")}var p="function"==typeof Symbol&&Symbol.iterator;function h(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)n+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function f(e,n,t){this.props=e,this.context=n,this.refs=m,this.updater=t||g}function y(){}function v(e,n,t){this.props=e,this.context=n,this.refs=m,this.updater=t||g}f.prototype.isReactComponent={},f.prototype.setState=function(e,n){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,n,"setState")},f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=f.prototype;var b=v.prototype=new y;b.constructor=v,r(b,f.prototype),b.isPureReactComponent=!0;var k={current:null},x=Object.prototype.hasOwnProperty,j={key:!0,ref:!0,__self:!0,__source:!0};function w(e,n,t){var r,o={},s=null,a=null;if(null!=n)for(r in void 0!==n.ref&&(a=n.ref),void 0!==n.key&&(s=""+n.key),n)x.call(n,r)&&!j.hasOwnProperty(r)&&(o[r]=n[r]);var c=arguments.length-2;if(1===c)o.children=t;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===o[r]&&(o[r]=c[r]);return{$$typeof:i,type:e,key:s,ref:a,props:o,_owner:k.current}}function P(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var _=/\/+/g;function E(e,n){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return n[e]}))}(""+e.key):n.toString(36)}function R(e,n,t,r,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case i:case o:c=!0}}if(c)return s=s(c=e),e=""===r?"."+E(c,0):r,Array.isArray(s)?(t="",null!=e&&(t=e.replace(_,"$&/")+"/"),R(s,n,t,"",(function(e){return e}))):null!=s&&(P(s)&&(s=function(e,n){return{$$typeof:i,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}(s,t+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(_,"$&/")+"/")+e)),n.push(s)),1;if(c=0,r=""===r?".":r+":",Array.isArray(e))for(var l=0;l<e.length;l++){var u=r+E(a=e[l],l);c+=R(a,n,t,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=R(a=a.value,n,t,u=r+E(a,l++),s);else if("object"===a)throw n=""+e,Error(h(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n));return c}function C(e,n,t){if(null==e)return e;var r=[],i=0;return R(e,r,"","",(function(e){return n.call(t,e,i++)})),r}function S(e){if(-1===e._status){var n=e._result;n=n(),e._status=0,e._result=n,n.then((function(n){0===e._status&&(n=n.default,e._status=1,e._result=n)}),(function(n){0===e._status&&(e._status=2,e._result=n)}))}if(1===e._status)return e._result;throw e._result}var O={current:null};function A(){var e=O.current;if(null===e)throw Error(h(321));return e}var I={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:k,IsSomeRendererActing:{current:!1},assign:r};n.Children={map:C,forEach:function(e,n,t){C(e,(function(){n.apply(this,arguments)}),t)},count:function(e){var n=0;return C(e,(function(){n++})),n},toArray:function(e){return C(e,(function(e){return e}))||[]},only:function(e){if(!P(e))throw Error(h(143));return e}},n.Component=f,n.PureComponent=v,n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,n.cloneElement=function(e,n,t){if(null==e)throw Error(h(267,e));var o=r({},e.props),s=e.key,a=e.ref,c=e._owner;if(null!=n){if(void 0!==n.ref&&(a=n.ref,c=k.current),void 0!==n.key&&(s=""+n.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in n)x.call(n,u)&&!j.hasOwnProperty(u)&&(o[u]=void 0===n[u]&&void 0!==l?l[u]:n[u])}var u=arguments.length-2;if(1===u)o.children=t;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];o.children=l}return{$$typeof:i,type:e.type,key:s,ref:a,props:o,_owner:c}},n.createContext=function(e,n){return void 0===n&&(n=null),(e={$$typeof:a,_calculateChangedBits:n,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},n.createElement=w,n.createFactory=function(e){var n=w.bind(null,e);return n.type=e,n},n.createRef=function(){return{current:null}},n.forwardRef=function(e){return{$$typeof:c,render:e}},n.isValidElement=P,n.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:S}},n.memo=function(e,n){return{$$typeof:l,type:e,compare:void 0===n?null:n}},n.useCallback=function(e,n){return A().useCallback(e,n)},n.useContext=function(e,n){return A().useContext(e,n)},n.useDebugValue=function(){},n.useEffect=function(e,n){return A().useEffect(e,n)},n.useImperativeHandle=function(e,n,t){return A().useImperativeHandle(e,n,t)},n.useLayoutEffect=function(e,n){return A().useLayoutEffect(e,n)},n.useMemo=function(e,n){return A().useMemo(e,n)},n.useReducer=function(e,n,t){return A().useReducer(e,n,t)},n.useRef=function(e){return A().useRef(e)},n.useState=function(e){return A().useState(e)},n.version="17.0.2"},827378:(e,n,t)=>{e.exports=t(541535)},824246:(e,n,t)=>{e.exports=t(371426)},511151:(e,n,t)=>{t.d(n,{Zo:()=>a,ah:()=>o});var r=t(667294);const i=r.createContext({});function o(e){const n=r.useContext(i);return r.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const s={};function a({components:e,children:n,disableParentContext:t}){let a;return a=t?"function"==typeof e?e({}):e||s:o(e),r.createElement(i.Provider,{value:a},n)}}}]);